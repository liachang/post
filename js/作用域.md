### 作用域

1. 全局作用域

   ```
   作用于所有代码执行的环境(整个 script 标签内部)或者一个独立的 js 文件。
   ```

2. 局部作用域

   ```
   作用于函数内的代码环境，就是局部作用域。 因为跟函数有关系，所以也称为函数作用域。
   ```

3. 块级作用域

   ```
   块作用域由 { } 包括。
   在其他编程语言中，在 if 语句、循环语句中创建的变量，仅仅只能在本 if 语句、本循环语句中使用
   es6后有块级作用域
   ```




### 预解析

1. ```
   JavaScript 解析器在运行 JavaScript 代码的时候分为两步：预解析和代码执行。
   预解析：
   找到所有的声明，并用合适的作用域将他们关联起来
   默认把带有 var 和 function 声明的变量提升到当前作用域的最顶端进行提前声明或者定义。
   ```

2. 也叫做变量、函数提升。

3. 问题：

   用函数表达式声明的函数，声明必须在调用之前，因为只进行了变量的提升？

   ##### 变量：

   ```
   没有用var声明的变量自动声明为全局变量
   let和const：提升后不会初始化为undefined，引用会报错reference error，相当于没有提升
   console.log(a)
   var a  // undefined
   ```

   ##### 函数

   ```
   函数式声明：
   console.log(f1) // f f1(){xxx}
   function f1(){xxx}
   相当于把整个函数块进行提升，且可执行
   函数字面量式：
   console.log(f2) // undefined
   var f2 = function(){xxx}
   相当于变量提升
   执行会报错 TypeError: f2 is not a function
   ```

   

### 作用域链

```
根据内部函数可以访问外部函数变量的这种机制，用链式查找决定哪些数据能被内部函数访问，就称作作用域链
子对象会一级一级地向上寻找所有父对象的变量。
所以，父对象的所有变量，对子对象都是可见的，反之则不成立。
```





#### 闭包

```
一个函数和对其周围状态（lexical environment，词法环境）的引用捆绑在一起，这样的组合就是闭包（closure）。
也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域。
闭包就是将函数内部和函数外部连接起来的一座桥梁
每当创建一个函数，闭包就会在函数创建的同时被创建出来。
```

```
用途：
引用外部变量
让变量的值始终保存在内存当中
例如
function f1(){
	var n = 100
	function f2()
	{
		alert('n')
	}
	nadd = function n_add(){
		n += 1
	}
}
var result = f1()
result() //100
nadd()
result()// 101
f1中的局部变量没有因f1的调用而清楚，因为f2依赖于f1,而f2又被赋给了全局变量result，故局部变量n一直保存在内存当中
```

```
问题：
由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，造成网页的性能问题
闭包会在父函数外部，改变父函数内部变量的值。
```

